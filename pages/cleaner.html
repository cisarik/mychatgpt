<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Search Cleaner</title>
    <link rel="stylesheet" href="../styles.css" />
  </head>
  <body>
    <main class="page">
      <header class="page__header">
        <div>
          <h1>Search Cleaner</h1>
          <p>Keep short chat-based searches backed up locally for manual cleanup.</p>
        </div>
        <div class="header__actions">
          <button id="scan-button" type="button" class="secondary">Scan</button>
          <button id="refresh-button" type="button" class="secondary">Refresh</button>
        </div>
      </header>

      <section class="toolbar">
        <span id="selection-counter" class="status-muted">0 selected</span>
        <button id="open-next-button" type="button" disabled>Open next (5)</button>
      </section>

      <section>
        <table class="backup-table" aria-live="polite">
          <thead>
            <tr>
              <th scope="col" class="col-select">
                <input id="select-all" type="checkbox" aria-label="Select all" />
              </th>
              <th scope="col" class="col-time">Time</th>
              <th scope="col">Prompt preview</th>
              <th scope="col">Backup?</th>
              <th scope="col" class="col-actions">Actions</th>
            </tr>
          </thead>
          <tbody id="backup-body"></tbody>
        </table>
        <p id="empty-state" class="empty-state" hidden>No captured conversations yet.</p>
      </section>

      <details class="settings" id="settings-panel">
        <summary>Settings</summary>
        <form id="settings-form">
          <div class="field">
            <label for="maxMessageCount">Max messages</label>
            <input id="maxMessageCount" name="maxMessageCount" type="number" min="1" max="6" />
          </div>
          <div class="field">
            <label for="maxAgeMinutes">Max age (minutes)</label>
            <input id="maxAgeMinutes" name="maxAgeMinutes" type="number" min="1" max="60" />
          </div>
          <div class="field">
            <label for="maxPromptLength">Max prompt length</label>
            <input id="maxPromptLength" name="maxPromptLength" type="number" min="40" max="2000" />
          </div>
          <div class="field">
            <label for="maxAnswerLength">Max answer length</label>
            <input id="maxAnswerLength" name="maxAnswerLength" type="number" min="200" max="12000" />
          </div>
          <div class="field">
            <label for="batchSize">Open batch size</label>
            <input id="batchSize" name="batchSize" type="number" min="1" max="10" />
          </div>
          <div class="field">
            <label for="deletionStrategyId">Deletion strategy</label>
            <select id="deletionStrategyId" name="deletionStrategyId">
              <option value="manual-open">Manual open (default)</option>
              <option value="ui-automation" disabled title="coming soon">UI automation (risky)</option>
            </select>
          </div>
          <div class="field field-inline">
            <label for="debugLogs">Debug log toggle</label>
            <input id="debugLogs" name="debugLogs" type="checkbox" />
          </div>
          <div class="field">
            <button type="submit">Save settings</button>
          </div>
        </form>
      </details>

      <section class="debug-panel" id="debug-panel" hidden aria-live="polite">
        <header>
          <h2>Debug log</h2>
          <div class="header__actions">
            <button id="refresh-logs" type="button" class="secondary">Refresh logs</button>
            <button id="clear-logs" type="button" class="secondary">Clear logs</button>
          </div>
        </header>
        <pre id="logs-output">(debug disabled)</pre>
      </section>
    </main>
    <div id="status-root" class="toast-root" aria-live="polite"></div>
    <script type="module" src="cleaner.js"></script>
  </body>
</html>
